'''
Joe Walter

difficulty: 5% (debatable)
run time:   0:00
answer:     1517926517777556

	***

700 Eulercoin

Leonhard Euler was born on 15 April 1707.

Consider the sequence 1504170715041707n mod 4503599627370517.

An element of this sequence is defined to be an Eulercoin if it is strictly smaller than all previously found Eulercoins.

For example, the first term is 1504170715041707 which is the first Eulercoin. The second term is 3008341430083414 which is greater than 1504170715041707 so is not an Eulercoin. However, the third term is 8912517754604 which is small enough to be a new Eulercoin.

The sum of the first 2 Eulercoins is therefore 1513083232796311.

Find the sum of all Eulercoins.

	***

I solved this purely by recognizing a pattern in the eulercoins, and extending that pattern to the last coin (0). I don't really know why this pattern is the way it is or why it works.

Iterate until e_n = 0:
	del = e_n-1 - e_n
	If e_n < del, then del = del % e_n.
	e_n+1 = e_n - del.
'''

def ecoins():
	'''Generate eulercoins naively. Good for recognizing patterns.'''
	n   = 0
	d   = 1504170715041707
	mod = 4503599627370517
	min = 9999999999999999
	sum = 0

	while True:
		n = (n+d)%mod
		if n < min:
			min_diff = min - n
			min = n
			sum += n
			print((sum, min, min_diff, min-min_diff))
#ecoins()

def solve():
	'''Copy the pattern observed in eulercoins.'''

	# start with the second eulercoin so min_diff is defined
	sum = 1513083232796311
	min = 8912517754604
	min_diff = 1495258197287103

	while min > 0:
		if min_diff > min:
			min_diff %= min
		min -= min_diff
		sum += min
		#print((sum, min, min_diff))
	return sum

print(solve())

'''
(1504170715041707, 1504170715041707, 8495829284958292, -6991658569916585)
(1513083232796311, 8912517754604, 1495258197287103, -1486345679532499)   <--- min_diff = ??? (previous min_diff isn't actually defined)
(1515128018282680, 2044785486369, 6867732268235, -4822946781866)   <--- min_diff = min_diff - min*167 (obs: >167 & min_diff goes < 0)
(1516439427959921, 1311409677241, 733375809128, 578033868113)   <--- min_diff = min_diff - min*3
(1517017461828034, 578033868113, 733375809128, -155341941015)
(1517440153755132, 422691927098, 155341941015, 267349986083)    <---- min_diff = min_diff - min
(1517707503741215, 267349986083, 155341941015, 112008045068)
(1517819511786283, 112008045068, 155341941015, -43333895947)
(1517888185935404, 68674149121, 43333895947, 25340253174)       <---- min_diff = min_diff - min
(1517913526188578, 25340253174, 43333895947, -17993642773)
(1517920872798979, 7346610401, 17993642773, -10647032372) <---- min_diff = min_diff - min
(1517924918987409, 4046188430, 3300421971, 745766459)     <---- min_diff = min_diff - min*2
(1517925664753868, 745766459, 3300421971, -2554655512)
(1517926093164192, 428410324, 317356135, 111054189)
(1517926204218381, 111054189, 317356135, -206301946)
(1517926220024813, 15806432, 95247757, -79441325)     <---- min_diff = min_diff - min*2
(1517926235422080, 15397267, 409165, 14988102)     <---- min_diff = min_diff - min*6
(1517926250410182, 14988102, 409165, 14578937)
(1517926264989119, 14578937, 409165, 14169772)
(1517926279158891, 14169772, 409165, 13760607)
(1517926292919498, 13760607, 409165, 13351442)
(1517926306270940, 13351442, 409165, 12942277)
(1517926319213217, 12942277, 409165, 12533112)
(1517926331746329, 12533112, 409165, 12123947)
(1517926343870276, 12123947, 409165, 11714782)
(1517926355585058, 11714782, 409165, 11305617)
(1517926366890675, 11305617, 409165, 10896452)
(1517926377787127, 10896452, 409165, 10487287)
(1517926388274414, 10487287, 409165, 10078122)
(1517926398352536, 10078122, 409165, 9668957)
(1517926408021493, 9668957, 409165, 9259792)
(1517926417281285, 9259792, 409165, 8850627)
(1517926426131912, 8850627, 409165, 8441462)
(1517926434573374, 8441462, 409165, 8032297)
(1517926442605671, 8032297, 409165, 7623132)
(1517926450228803, 7623132, 409165, 7213967)
(1517926457442770, 7213967, 409165, 6804802)
(1517926464247572, 6804802, 409165, 6395637)
(1517926470643209, 6395637, 409165, 5986472)
(1517926476629681, 5986472, 409165, 5577307)
(1517926482206988, 5577307, 409165, 5168142)
(1517926487375130, 5168142, 409165, 4758977)
(1517926492134107, 4758977, 409165, 4349812)
(1517926496483919, 4349812, 409165, 3940647)
(1517926500424566, 3940647, 409165, 3531482)
(1517926503956048, 3531482, 409165, 3122317)
(1517926507078365, 3122317, 409165, 2713152)
(1517926509791517, 2713152, 409165, 2303987)
(1517926512095504, 2303987, 409165, 1894822)
(1517926513990326, 1894822, 409165, 1485657)
(1517926515475983, 1485657, 409165, 1076492)
(1517926516552475, 1076492, 409165, 667327)
(1517926517219802, 667327, 409165, 258162)
(1517926517477964, 258162, 409165, -151003)
(1517926517585123, 107159, 151003, -43844)
'''
