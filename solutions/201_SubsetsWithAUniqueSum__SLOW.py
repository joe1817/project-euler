'''
Joe Walter

difficulty: 65%
run time:   1:05:00
answer:     115039000

	***

201 Subsets with a Unique Sum

For any set A of numbers, let sum(A) be the sum of the elements of A.

Consider the set B = {1,3,6,8,10,11}. There are 20 subsets of B containing three elements, and their sums are:

sum({1,3,6})   = 10,
sum({1,3,8})   = 12,
sum({1,3,10})  = 14,
sum({1,3,11})  = 15,
sum({1,6,8})   = 15,
sum({1,6,10})  = 17,
sum({1,6,11})  = 18,
sum({1,8,10})  = 19,
sum({1,8,11})  = 20,
sum({1,10,11}) = 22,
sum({3,6,8})   = 17,
sum({3,6,10})  = 19,
sum({3,6,11})  = 20,
sum({3,8,10})  = 21,
sum({3,8,11})  = 22,
sum({3,10,11}) = 24,
sum({6,8,10})  = 24,
sum({6,8,11})  = 25,
sum({6,10,11}) = 27,
sum({8,10,11}) = 29.

Some of these sums occur more than once, others are unique.

For a set A, let U(A,k) be the set of unique sums of k-element subsets of A, in our example we find U(B,3) = {10,12,14,18,21,25,27,29} and sum(U(B,3)) = 156.>

Now consider the 100-element set S = {1^2, 2^2,..., 100^2}.

S has 100891344545564193334812497256 50-element subsets.

Determine the sum of all integers which are the sum of exactly one of the 50-element subsets of S, i.e. find sum(U(S,50)).
'''

# brute force, for debugging
def U0(S, n):
	from collections import Counter
	from itertools import combinations
	C = Counter()
	for s in combinations(S, n):
		ss = sum(s)
	#	if ss == 55:
	#		print(s)
		C[ss] += 1
	#print(C)
	return {s for s,c in C.items() if c==1}



def add_pairs(a, b):
	for x in a:
		for y in b:
			yield x+y


# problem: two unique sub-sums could add to a non-unique total. Having unique sub-sums is a necessary *but not sufficient* condition for the sum being unique.
# example: consider [1,3,6,8,10,11,13,17,22]
# 55 = 3 + 6 	+ 	11 + 13 + 22
# 55 = 1 + 8 	+ 	11 + 13 + 22	(3+6 and 1+8 sub-sums were identified, which caused the whole sum to be ignored, incorrectly suggesting 55 was unique when it was seen again later)
# 55 = 6 + 8 	+ 	11 + 13 + 17	(6+8 and 11+13+17 are unique sub-sums in their respective recursive steps)
from collections import Counter
def U(S, n):
	if n == 0:
		return {0}
	if len(S) == n:
		return {sum(S)}
	
	m = len(S)//2
	a = S[:m]
	b = S[m:]	
	uniq = Counter()

	for i in range(n+1):
		j = n-i
		if i > len(a):
			break
		if j > len(b):
			continue
		Ua = U(a,i)
		Ub = U(b,j)
		uniq += Counter(add_pairs(Ua, Ub))

	uniq = {s for s,c in uniq.items() if c==1}

	return uniq # POTENTIALLY unique






# Same as U but includes the set of squares that sum to each number
def U2(S, n):
	if n == 0:
		return { (0,tuple()) }
	if len(S) == n:
		return { (sum(S),tuple(S)) }
	
	m = len(S)//2
	a = S[:m]
	b = S[m:]	
	combined = []

	for i in range(n+1):
		j = n-i
		if i > len(a):
			break
		if j > len(b):
			continue
		Ua = U2(a,i)
		Ub = U2(b,j)
		
		for Va, Sa in Ua:
			for Vb, Sb in Ub:
				combined.append((Va+Vb, Sa+Sb))

	count = Counter(v for v,s in combined)

	return {(v,s) for v,s in combined if count[v]==1}

A = [x*x for x in range(1,15)]
print(U0(A,5))
for x in U2(A,5):
	print(x)
input()




# U doesn't work well unless input list is shuffled
from random import shuffle
A = [1,3,6,8,10,11,13,17,22,23]
print(sorted(U0(A,5)))
print(sorted(U(A,5))) # wrong
shuffle(A)
print(sorted(U(A,5))) # often correct






B = [1,3,6,8,10,11]
assert sum(U(B, 3)) == 156
print("Pass")

S = [n*n for n in range(1, 101)]
k = 50
u = U(S, k)
shuffle(S)
print(sum(u))
u = u.intersection(U(S, k))
print(sum(u))

input("Done")




# Observations
# If A has a unique subset sum, then S-A also has a unique sum
# So, U(S,k) = sum(S)*(number of unique subset sums)/2
# The smaller of each subset sum pair is <= sum(S)/2 = 169175
# All the smaller of the correct subset sums below are much lower than this theoretical limit
# It would be very fast to solve this problem if the limit of 45047 can be deduced
# (Just do a brute force, skipping subsets than sum above 45047)
# However, I'd like to solve this without making this non-obvious assumption



# correct, sum=115039000
'''
[42925, 43026, 43125, 43129, 43222, 43228, 43234, 43317, 43325, 43329, 43333, 43341, 43410, 43420, 43426, 43430, 43434, 43440, 43450, 43501, 43513, 43521, 43531, 43541, 43549, 43561, 43590, 43604, 43614, 43618, 43620, 43626, 43630, 43632, 43634, 43638, 43644, 43646, 43650, 43660, 43674, 43677, 43693, 43705, 43709, 43713, 43717, 43719, 43729, 43737, 43747, 43749, 43753, 43757, 43761, 43762, 43773, 43780, 43789, 43794, 43798, 43804, 43816, 43818, 43826, 43828, 43832, 43836, 43840, 43842, 43845, 43850, 43852, 43864, 43865, 43870, 43874, 43881, 43885, 43888, 43893, 43899, 43901, 43906, 43909, 43913, 43915, 43917, 43921, 43926, 43948, 43949, 43953, 43955, 43957, 43961, 43966, 43969, 43970, 43971, 43977, 43980, 43985, 43986, 43989, 43990, 43992, 43996, 43998, 44002, 44010, 44012, 44014, 44016, 44018, 44020, 44025, 44028, 44029, 44032, 44040, 44044, 44049, 44052, 44053, 44054, 44056, 44058, 44060, 44062, 44065, 44070, 44071, 44074, 44076, 44080, 44086, 44092, 44093, 44095, 44102, 44105, 44106, 44108, 44115, 44117, 44124, 44130, 44131, 44134, 44143, 44146, 44148, 44154, 44159, 44160, 44162, 44169, 44170, 44172, 44174, 44179, 44181, 44182, 44186, 44188, 44190, 44192, 44194, 44196, 44198, 44203, 44204, 44210, 44212, 44213, 44216, 44221, 44222, 44224, 44225, 44228, 44229, 44232, 44235, 44236, 44240, 44241, 44244, 44246, 44248, 44252, 44253, 44254, 44261, 44264, 44265, 44266, 44267, 44272, 44273, 44278, 44280, 44281, 44282, 44283, 44284, 44285, 44287, 44288, 44293, 44294, 44295, 44299, 44302, 44304, 44306, 44308, 44316, 44320, 44322, 44323, 44326, 44328, 44331, 44334, 44335, 44338, 44340, 44343, 44346, 44347, 44355, 44360, 44362, 44364, 44368, 44379, 44383, 44384, 44392, 44393, 44395, 44396, 44411, 44418, 44425, 44429, 44431, 44436, 44442, 44443, 44444, 44449, 44451, 44453, 44455, 44462, 44463, 44471, 44472, 44483, 44484, 44486, 44488, 44489, 44495, 44496, 44498, 44499, 44502, 44513, 44514, 44518, 44519, 44523, 44526, 44534, 44542, 44543, 44544, 44548, 44552, 44558, 44559, 44563, 44570, 44582, 44583, 44588, 44596, 44599, 44607, 44611, 44612, 44618, 44623, 44627, 44631, 44647, 44651, 44655, 44657, 44666, 44675, 44679, 44688, 44695, 44696, 44699, 44702, 44703, 44708, 44715, 44728, 44735, 44739, 44747, 44752, 44771, 44776, 44783, 44787, 44795, 44804, 44823, 44835, 44843, 44847, 44859, 44863, 44867, 44883, 44887, 44903, 44927, 44936, 44987, 45031, 45047, 293303, 293319, 293363, 293414, 293423, 293447, 293463, 293467, 293483, 293487, 293491, 293503, 293507, 293515, 293527, 293546, 293555, 293563, 293567, 293574, 293579, 293598, 293603, 293611, 293615, 293622, 293635, 293642, 293647, 293648, 293651, 293654, 293655, 293662, 293671, 293675, 293684, 293693, 293695, 293699, 293703, 293719, 293723, 293727, 293732, 293738, 293739, 293743, 293751, 293754, 293762, 293767, 293768, 293780, 293787, 293791, 293792, 293798, 293802, 293806, 293807, 293808, 293816, 293824, 293827, 293831, 293832, 293836, 293837, 293848, 293851, 293852, 293854, 293855, 293861, 293862, 293864, 293866, 293867, 293878, 293879, 293887, 293888, 293895, 293897, 293899, 293901, 293906, 293907, 293908, 293914, 293919, 293921, 293925, 293932, 293939, 293954, 293955, 293957, 293958, 293966, 293967, 293971, 293982, 293986, 293988, 293990, 293995, 294003, 294004, 294007, 294010, 294012, 294015, 294016, 294019, 294022, 294024, 294027, 294028, 294030, 294034, 294042, 294044, 294046, 294048, 294051, 294055, 294056, 294057, 294062, 294063, 294065, 294066, 294067, 294068, 294069, 294070, 294072, 294077, 294078, 294083, 294084, 294085, 294086, 294089, 294096, 294097, 294098, 294102, 294104, 294106, 294109, 294110, 294114, 294115, 294118, 294121, 294122, 294125, 294126, 294128, 294129, 294134, 294137, 294138, 294140, 294146, 294147, 294152, 294154, 294156, 294158, 294160, 294162, 294164, 294168, 294169, 294171, 294176, 294178, 294180, 294181, 294188, 294190, 294191, 294196, 294202, 294204, 294207, 294216, 294219, 294220, 294226, 294233, 294235, 294242, 294244, 294245, 294248, 294255, 294257, 294258, 294264, 294270, 294274, 294276, 294279, 294280, 294285, 294288, 294290, 294292, 294294, 294296, 294297, 294298, 294301, 294306, 294310, 294318, 294321, 294322, 294325, 294330, 294332, 294334, 294336, 294338, 294340, 294348, 294352, 294354, 294358, 294360, 294361, 294364, 294365, 294370, 294373, 294379, 294380, 294381, 294384, 294389, 294393, 294395, 294397, 294401, 294402, 294424, 294429, 294433, 294435, 294437, 294441, 294444, 294449, 294451, 294457, 294462, 294465, 294469, 294476, 294480, 294485, 294486, 294498, 294500, 294505, 294508, 294510, 294514, 294518, 294522, 294524, 294532, 294534, 294546, 294552, 294556, 294561, 294570, 294577, 294588, 294589, 294593, 294597, 294601, 294603, 294613, 294621, 294631, 294633, 294637, 294641, 294645, 294657, 294673, 294676, 294690, 294700, 294704, 294706, 294712, 294716, 294718, 294720, 294724, 294730, 294732, 294736, 294746, 294760, 294789, 294801, 294809, 294819, 294829, 294837, 294849, 294900, 294910, 294916, 294920, 294924, 294930, 294940, 295009, 295017, 295021, 295025, 295033, 295116, 295122, 295128, 295221, 295225, 295324, 295425]
'''

# incorrect, sum=115377350, {44943, 293407} extraneous
'''
[42925, 43026, 43125, 43129, 43222, 43228, 43234, 43317, 43325, 43329, 43333, 43341, 43410, 43420, 43426, 43430, 43434, 43440, 43450, 43501, 43513, 43521, 43531, 43541, 43549, 43561, 43590, 43604, 43614, 43618, 43620, 43626, 43630, 43632, 43634, 43638, 43644, 43646, 43650, 43660, 43674, 43677, 43693, 43705, 43709, 43713, 43717, 43719, 43729, 43737, 43747, 43749, 43753, 43757, 43761, 43762, 43773, 43780, 43789, 43794, 43798, 43804, 43816, 43818, 43826, 43828, 43832, 43836, 43840, 43842, 43845, 43850, 43852, 43864, 43865, 43870, 43874, 43881, 43885, 43888, 43893, 43899, 43901, 43906, 43909, 43913, 43915, 43917, 43921, 43926, 43948, 43949, 43953, 43955, 43957, 43961, 43966, 43969, 43970, 43971, 43977, 43980, 43985, 43986, 43989, 43990, 43992, 43996, 43998, 44002, 44010, 44012, 44014, 44016, 44018, 44020, 44025, 44028, 44029, 44032, 44040, 44044, 44049, 44052, 44053, 44054, 44056, 44058, 44060, 44062, 44065, 44070, 44071, 44074, 44076, 44080, 44086, 44092, 44093, 44095, 44102, 44105, 44106, 44108, 44115, 44117, 44124, 44130, 44131, 44134, 44143, 44146, 44148, 44154, 44159, 44160, 44162, 44169, 44170, 44172, 44174, 44179, 44181, 44182, 44186, 44188, 44190, 44192, 44194, 44196, 44198, 44203, 44204, 44210, 44212, 44213, 44216, 44221, 44222, 44224, 44225, 44228, 44229, 44232, 44235, 44236, 44240, 44241, 44244, 44246, 44248, 44252, 44253, 44254, 44261, 44264, 44265, 44266, 44267, 44272, 44273, 44278, 44280, 44281, 44282, 44283, 44284, 44285, 44287, 44288, 44293, 44294, 44295, 44299, 44302, 44304, 44306, 44308, 44316, 44320, 44322, 44323, 44326, 44328, 44331, 44334, 44335, 44338, 44340, 44343, 44346, 44347, 44355, 44360, 44362, 44364, 44368, 44379, 44383, 44384, 44392, 44393, 44395, 44396, 44411, 44418, 44425, 44429, 44431, 44436, 44442, 44443, 44444, 44449, 44451, 44453, 44455, 44462, 44463, 44471, 44472, 44483, 44484, 44486, 44488, 44489, 44495, 44496, 44498, 44499, 44502, 44513, 44514, 44518, 44519, 44523, 44526, 44534, 44542, 44543, 44544, 44548, 44552, 44558, 44559, 44563, 44570, 44582, 44583, 44588, 44596, 44599, 44607, 44611, 44612, 44618, 44623, 44627, 44631, 44647, 44651, 44655, 44657, 44666, 44675, 44679, 44688, 44695, 44696, 44699, 44702, 44703, 44708, 44715, 44728, 44735, 44739, 44747, 44752, 44771, 44776, 44783, 44787, 44795, 44804, 44823, 44835, 44843, 44847, 44859, 44863, 44867, 44883, 44887, 44903, 44927, 44936, 44943, 44987, 45031, 45047, 293303, 293319, 293363, 293407, 293414, 293423, 293447, 293463, 293467, 293483, 293487, 293491, 293503, 293507, 293515, 293527, 293546, 293555, 293563, 293567, 293574, 293579, 293598, 293603, 293611, 293615, 293622, 293635, 293642, 293647, 293648, 293651, 293654, 293655, 293662, 293671, 293675, 293684, 293693, 293695, 293699, 293703, 293719, 293723, 293727, 293732, 293738, 293739, 293743, 293751, 293754, 293762, 293767, 293768, 293780, 293787, 293791, 293792, 293798, 293802, 293806, 293807, 293808, 293816, 293824, 293827, 293831, 293832, 293836, 293837, 293848, 293851, 293852, 293854, 293855, 293861, 293862, 293864, 293866, 293867, 293878, 293879, 293887, 293888, 293895, 293897, 293899, 293901, 293906, 293907, 293908, 293914, 293919, 293921, 293925, 293932, 293939, 293954, 293955, 293957, 293958, 293966, 293967, 293971, 293982, 293986, 293988, 293990, 293995, 294003, 294004, 294007, 294010, 294012, 294015, 294016, 294019, 294022, 294024, 294027, 294028, 294030, 294034, 294042, 294044, 294046, 294048, 294051, 294055, 294056, 294057, 294062, 294063, 294065, 294066, 294067, 294068, 294069, 294070, 294072, 294077, 294078, 294083, 294084, 294085, 294086, 294089, 294096, 294097, 294098, 294102, 294104, 294106, 294109, 294110, 294114, 294115, 294118, 294121, 294122, 294125, 294126, 294128, 294129, 294134, 294137, 294138, 294140, 294146, 294147, 294152, 294154, 294156, 294158, 294160, 294162, 294164, 294168, 294169, 294171, 294176, 294178, 294180, 294181, 294188, 294190, 294191, 294196, 294202, 294204, 294207, 294216, 294219, 294220, 294226, 294233, 294235, 294242, 294244, 294245, 294248, 294255, 294257, 294258, 294264, 294270, 294274, 294276, 294279, 294280, 294285, 294288, 294290, 294292, 294294, 294296, 294297, 294298, 294301, 294306, 294310, 294318, 294321, 294322, 294325, 294330, 294332, 294334, 294336, 294338, 294340, 294348, 294352, 294354, 294358, 294360, 294361, 294364, 294365, 294370, 294373, 294379, 294380, 294381, 294384, 294389, 294393, 294395, 294397, 294401, 294402, 294424, 294429, 294433, 294435, 294437, 294441, 294444, 294449, 294451, 294457, 294462, 294465, 294469, 294476, 294480, 294485, 294486, 294498, 294500, 294505, 294508, 294510, 294514, 294518, 294522, 294524, 294532, 294534, 294546, 294552, 294556, 294561, 294570, 294577, 294588, 294589, 294593, 294597, 294601, 294603, 294613, 294621, 294631, 294633, 294637, 294641, 294645, 294657, 294673, 294676, 294690, 294700, 294704, 294706, 294712, 294716, 294718, 294720, 294724, 294730, 294732, 294736, 294746, 294760, 294789, 294801, 294809, 294819, 294829, 294837, 294849, 294900, 294910, 294916, 294920, 294924, 294930, 294940, 295009, 295017, 295021, 295025, 295033, 295116, 295122, 295128, 295221, 295225, 295324, 295425]
'''